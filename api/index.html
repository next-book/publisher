<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>@next-book/publisher</title>
	<meta name="description" content="Documentation for @next-book/publisher">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">@next-book/publisher</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>@next-book/publisher</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#next-book-publishing-tool" id="next-book-publishing-tool" style="color: inherit; text-decoration: none;">
					<h1>Next-book publishing tool</h1>
				</a>
				<p>@next-book/publisher is a tool for mapping HTML files for use with next-book tools. See <a href="http://next-book.github.io/publisher/">an example</a>, <a href="http://next-book.github.io/publisher/api">API documentations</a> or a <a href="https://github.com/next-book/free-culture/">example book created with publisher</a>, that builds functionalityon top of its markup: displaying and remembering position, tracing reader&#39;s journey through a book etc.</p>
				<a href="#use-with-nodejs" id="use-with-nodejs" style="color: inherit; text-decoration: none;">
					<h2>Use with node.js</h2>
				</a>
				<p>Install in a book&#39;s repository (global installation is discouraged as publisher is in its early development and API changes are expected):</p>
				<pre><code class="language-sh"><span style="color: #000000">npm i @next-book/publisher</span>
</code></pre>
				<a href="#cli-use" id="cli-use" style="color: inherit; text-decoration: none;">
					<h2>CLI use</h2>
				</a>
				<p>Use publish-nb command, e. g.</p>
				<pre><code class="language-sh"><span style="color: #000000">publish-nb --src text --out book</span>
</code></pre>
				<p>Mapper reads all <code>\*.html</code> files in the source directory (<code>--src</code>, by default <code>./src</code>), sorts them by filename, maps them and outputs the result into the <code>output</code> directory (<code>--out</code>, by default <code>./book</code>).</p>
				<p>It also creates a <code>spine.json</code> file that collects metadata about the book and adds several structural meta tags into files (prev, next, license, spine) that allow book traversal (with Javascript or native browser affordances).</p>
				<p>It&#39;s required to include a <code>book.json</code> file in the source directory that adds metadata and a list of chapters. It&#39;s possible to specify static folders that will be copied from source to output as they are.</p>
				<pre><code class="language-json"><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;meta&quot;</span><span style="color: #000000">: {</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;title&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Free Culture&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;author&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Lawrence Lessig&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;subtitle&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;How big media uses technology and the law to lock down culture and control creativity&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;published&quot;</span><span style="color: #000000">: </span><span style="color: #098658">2004</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;keywords&quot;</span><span style="color: #000000">: [</span><span style="color: #A31515">&quot;copyright law&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;intellectual property&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;public domain&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;web&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;Napster&quot;</span><span style="color: #000000">]</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;chapters&quot;</span><span style="color: #000000">: [</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;01-preface.html&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;02-introduction.html&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;03-piracy.html&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;04-property.html&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;05-puzzles.html&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;06-balances.html&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;07-conclusion.html&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;08-afterword.html&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;09-acknowledgments.html&quot;</span>
<span style="color: #000000">    ],</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;static&quot;</span><span style="color: #000000">: [</span><span style="color: #A31515">&quot;style&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;scripts&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;images&quot;</span><span style="color: #000000">]</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>You can preview the book on a local web server by running the <code>publish-nb</code> with <code>-w</code> flag (or with <code>--server</code> param).</p>
				<pre><code class="language-sh"><span style="color: #000000">publish-nb --src text --out book --server</span>
</code></pre>
				<a href="#use-in-browser" id="use-in-browser" style="color: inherit; text-decoration: none;">
					<h2>Use in browser</h2>
				</a>
				<p>Download @next-book/publisher from npm or github and include it in your project files. Check <a href="http://next-book.github.io/publisher/">the example with extensive highlighting</a> to see how the result looks like.</p>
				<pre><code class="language-html"><span style="color: #800000">&lt;script</span><span style="color: #000000FF"> </span><span style="color: #FF0000">type</span><span style="color: #000000FF">=</span><span style="color: #0000FF">&quot;text/javascript&quot;</span><span style="color: #000000FF"> </span><span style="color: #FF0000">src</span><span style="color: #000000FF">=</span><span style="color: #0000FF">&quot;./publisher/dist/browser.js&quot;</span><span style="color: #800000">&gt;&lt;/script&gt;</span>
<span style="color: #800000">&lt;script</span><span style="color: #000000FF"> </span><span style="color: #FF0000">type</span><span style="color: #000000FF">=</span><span style="color: #0000FF">&quot;text/javascript&quot;</span><span style="color: #800000">&gt;</span>
<span style="color: #000000FF">    </span><span style="color: #001080">window</span><span style="color: #000000FF">.</span><span style="color: #795E26">addEventListener</span><span style="color: #000000FF">(</span><span style="color: #A31515">&#039;load&#039;</span><span style="color: #000000FF">, () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000FF"> </span><span style="color: #001080">NbMapper</span><span style="color: #000000FF">.</span><span style="color: #795E26">mapHtml</span><span style="color: #000000FF">());</span>
<span style="color: #800000">&lt;/script&gt;</span>
</code></pre>
				<p>Browser use is currently primarily for quick try-outs, not intended for production use.</p>
				<a href="#use-in-a-nodejs-script" id="use-in-a-nodejs-script" style="color: inherit; text-decoration: none;">
					<h2>Use in a Node.js script</h2>
				</a>
				<p>Map HTML string or JSDOM objects in a script:</p>
				<pre><code class="language-js"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">html</span><span style="color: #000000"> = </span><span style="color: #A31515">&#039;...&#039;</span><span style="color: #000000">;</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">publisher</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;@next-book/publisher&#039;</span><span style="color: #000000">);</span>
<span style="color: #001080">publisher</span><span style="color: #000000">.</span><span style="color: #795E26">map</span><span style="color: #000000">(</span><span style="color: #001080">html</span><span style="color: #000000">);</span>
</code></pre>
				<p>Config the publisher with an options object <code>publisher.map(html, conf)</code>, see <a href="http://next-book.github.io/publisher/api/#options">API docs for Options</a>.</p>
				<a href="#contributing" id="contributing" style="color: inherit; text-decoration: none;">
					<h2>Contributing</h2>
				</a>
				<p>Clone repository and install devDependencies. Build a complete project with <code>npm run build</code>. Limit PRs only to changed source files.</p>
				<a href="#license" id="license" style="color: inherit; text-decoration: none;">
					<h2>License</h2>
				</a>
				<p>@next-book/publisher &copy; 2016–2020 next-book</p>
				<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Modules</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/Gauge.html">Gauge</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/app.html">app</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/chapter_navigation.html">chapter-<wbr>navigation</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/config.html">config</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/data_helper.html">data-<wbr>helper</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/i18n.html">i18n</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/index.html">index</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/parser.html">parser</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/producer.html">producer</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/revision.html">revision</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/service_worker_builder.html">service-<wbr>worker/builder</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/structures.html">structures</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/structures_ideas.html">structures/ideas</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/structures_parsedobj.html">structures/parsedobj</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/tagger.html">tagger</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/toc.html">toc</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/utils_dom.html">utils/dom</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/utils_fs.html">utils/fs</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/utils_regexp.html">utils/regexp</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>